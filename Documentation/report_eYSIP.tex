\documentclass[a4paper,12pt,oneside]{book}

%-------------------------------Start of the Preable------------------------------------------------
\usepackage{mathtools}
\usepackage[english]{babel}
\usepackage{blindtext}
%packagr for hyperlinks
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

\urlstyle{same}
%use of package fancy header
\usepackage{fancyhdr}
\setlength\headheight{26pt}
\fancyhf{}
%\rhead{\includegraphics[width=1cm]{logo}}
\lhead{\rightmark}
\rhead{\includegraphics[width=1cm]{logo}}
\fancyfoot[RE, RO]{\thepage}
\fancyfoot[CE, CO]{\href{http://www.e-yantra.org}{www.e-yantra.org}}

\pagestyle{fancy}

%use of package for section title formatting
\usepackage{titlesec}
\titleformat{\chapter}
  {\Large\bfseries} % format
  {}                % label
  {0pt}             % sep
  {\huge}           % before-code
 
%use of package tcolorbox for colorful textbox
\usepackage[most]{tcolorbox}
\tcbset{colback=cyan!5!white,colframe=cyan!75!black,halign title = flush center}

\newtcolorbox{mybox}[1]{colback=cyan!5!white,
colframe=cyan!75!black,fonttitle=\bfseries,
title=\textbf{\Large{#1}}}

%use of package marginnote for notes in margin
\usepackage{marginnote}

%use of packgage watermark for pages
%\usepackage{draftwatermark}
%\SetWatermarkText{\includegraphics{logo}}
\usepackage[scale=2,opacity=0.1,angle=0]{background}
\backgroundsetup{
contents={\includegraphics{logo}}
}

%use of newcommand for keywords color
\usepackage{xcolor}
\newcommand{\keyword}[1]{\textcolor{red}{\textbf{#1}}}

%package for inserting pictures
\usepackage{graphicx}

%package for highlighting
\usepackage{color,soul}

%new command for table
\newcommand{\head}[1]{\textnormal{\textbf{#1}}}


%----------------------End of the Preamble---------------------------------------


\begin{document}

%---------------------Title Page------------------------------------------------
\begin{titlepage}
\raggedright
{\Large eYSIP$-$2018\\[1 cm]}
{\Huge\scshape A system for solving jigsaw puzzle using multiple robots\\[.1 in]}
\vfill
\begin{flushright}
{\large Aniket Anantraj Navlur \\}
{\large Kiran Suvas Patil\\}
{\large Ashis Kumar Maharana\\}
{\large Mentor 1$:$ Abinav Sarkar\\}
{\large Mentor 2$:$ Kalind Karia\\}
{\large Duration of Internship: $ 21/05/2018-06/07/2018 $ \\}
\end{flushright}

{\itshape 2018, e-Yantra Publication}
\end{titlepage}
%-------------------------------------------------------------------------------

\chapter[Project Tag]{A System for Solving Jigsaw Puzzle using Multiple Robots}
\section*{Abstract}
The prime motive of this project is to develop a multi Robot based \hspace{0 em} Autonomous Puzzle Solver system that can solve a Jigsaw puzzle.
\section*{Overview of Task}
\begin{tabular}{| c | p{27 em} | }\hline
		\textbf{Task No.} & \hspace{7em}\textbf{Task}\\\hline
		1 &\small{ Python, OpenCV, Firebird V Intro,XBee Communication} \\\hline
		2 &\small{ Pose and orientation calculation of 2 Firebird robots using\hspace{3 em} color/Aruco markers }\\\hline
		3 &\small{ Programming the Go-To-Goal Controller for single Firebird V robot. Tuning the PID\hspace{0 em} values to perfection }\\\hline
		4 &\small{ Implementing path planning with Firebird V where obstacles have been placed in arena }\\\hline
		5 &\small{ Detection of jigsaw puzzle blocks using\hspace{0 em}Template Matching}\\\hline
		6 &\small{ Pick and place of blocks - gripper mechanism building }\\\hline
		7 &\small{ Implementing the entire solution for a given\hspace{0 em}jigsaw puzzle }\\\hline
		8 &\small{ Documentation and reporting results }\\\hline
	\end{tabular}

\subsection*{Completion status}
The project is completed till task$.$6  i.e. building Gripper mechanism. Implementation of the entire solution for a given puzzle is in progress.  

\section{Hardware parts}
\begin{itemize}
  \item FireBird Robots(2)
  \item  XBee(3)
  \begin{itemize}
  \item Xbee module
  \item xbee usb adapter board
  \item usb type B to type A converter
  \end{itemize}
   \item overhead camera
   \item ArUco markers
   \item Servo motors for gripper mechanism
   \item flex sheet for arena
   \item puzzle pieces
\end{itemize}

\section{Software used}
\begin{itemize}
  \item python
  \item openCV
  \item AVR Studio 5.1
  \item XCTU(latest version)
  \item AVRDude
  \item Fusion360
\end{itemize}

\section{Assembly of hardware}
Circuit diagram and Steps of assembly of hardware with pictures for each step
\subsection*{Circuit Diagram}
Circuit schematic, simplified circuit diagram , block diagram of system
\subsection*{Step 1}
Steps for assembling part 1
\subsection*{Step 2}
Steps for assembling part 2
\subsection*{Step 3}
Steps for assembling part 3



\section{Software and Code}
\subsection{Dependencies}
Before configuring the XBee modules one should first understand the different parameters of it. This \href{https://learn.sparkfun.com/tutorials/exploring-xbees-and-xctu}{article} should help.  For configuring the xbee modules latest XCTU software is used. The channel is chosen so, such that no other device interfere the communication. \\
Detection of ArUco markers using python requires integration of aruco library to the current python version installed. The aruco library can be found in opencv-contrib module. For installing opencv-contrib follow these \href{https://www.youtube.com/watch?v=jnpC_Ib_lbc}{steps}$($ installing modules using pip  $)$. 
\begin{center} 
\framebox{\textcolor{gray}{ pip install opencv-contrib-python }}
\end{center}
For communicating to xbee module using python requires xbee and pyserial module. There are many similar modules for serial communication and xbee, but we need these two modules. If you want to learn you can search and go through other modules also.
\begin{enumerate}
\item \href{https://pypi.org/project/pyserial/}{pyserial}
\begin{center} 
\framebox{\textcolor{gray}{ pip install pyserial }}
\end{center}
\item \href{https://pypi.org/project/XBee/}{xbee}
\begin{center}
\framebox{\textcolor{gray}{ pip install xbee }}
\end{center}
\item optional \href{https://pypi.org/project/digi-xbee/}{digi-xbee}
\begin{center}
\fbox{\textcolor{gray}{ pip install digi-xbee }}
\end{center}
\end{enumerate}\vspace{0 em}
The xbee model provided(XBee S2C) cannot be read properly using the earlier versions of XCTU. So it is recommended to use the \href{https://www.digi.com/support/productdetail?pid=3352&type=utilities}{latest version}. Follow the previous Docs for configuration using XCTU. After configuration and testing over XCTU, communication is again tested using the python script. Once the communication is established it is time to connect the xbee modules on the Firebird V robots. How to guide can be found in the hardware manual of Firebird V.\\
Then comes the localisation of robots. For that purpose we are using overhead camera and ArUco markers. The position and orientation of the ArUco marker is first calculated using python script and \href{https://docs.python.org/2/library/math.html}{math module} which is inbuilt in python. Angle is calculated such that it ranges from 0 to 360 degrees. The python script can be found \href{https://github.com/eYSIP-2018/Jigsaw_Puzzle_Solver_using_Multiple_Robots/blob/master/Scripts/Aruco_pose.py}{here}.\\
For the Go$-$To$-$Goal Controller we first found the orientation and distance of the robot from its goal or destination. Then the error angle is calculated by subtracting angle with respect to frame from angle with respect to destination. The code can be found \href{https://github.com/eYSIP-2018/Jigsaw_Puzzle_Solver_using_Multiple_Robots/blob/master/Scripts/Aruco_pose_with_other_point.py}{here}. In another way the error angle can be found by\\
\begin{equation}
error angle = \arctan \left (\frac{m - n}{1 - m\times n}\right)
\end{equation}
\begin{center}
m = orientation of robot with respect to frame\\
\hspace{2.7 em}n = orientation of robot with respect to destination\end{center}
This error angle is then passed to the PID controller which then adjusts the speed of motors to maintain a zero error. The python script sends data packets to the Firebird V robot via Xbee. These data packets are formed by the following values.
\begin{equation}
\left\langle T|d_x|d_y|P|K_p|K_i|K_d|R|r_x|r_y|A|angle |\right\rangle
\end{equation}
\begin{center}
$<$ symbolizes beginning of data packet\\
T symbolizes target\\
d\textsubscript{x} $=$ destination x co-ordinate\\
d\textsubscript{y} $=$ destination y co-ordinate\\
P symbolizes PID gains\\
K\textsubscript{p} $=$ proportional gain\\
K\textsubscript{i} $=$ integral gain\\
K\textsubscript{d} $=$ differential gain\\
R symbolizes robot position\\
r\textsubscript{x} $=$ robot x co-ordinate\\
r\textsubscript{y} $=$ robot y co-ordinate\\
A symbolizes error angle\\
$>$ symbolizes end of packet\end{center}
Once received the packet is successfully parsed by the robot in an ISR and the speeds are assigned to the motors as PWM duty-cycle.The \href{}{c code} and python \href{}{script} can be found here. 


\href{http://www.github.com}{Github link} for the repository of code

Brief explanation of various parts of code 

\section{Use and Demo}
Final Setup Image

User Instruction for demonstration

\href{http://www.youtube.com}{Youtube Link} of demonstration video 

\section{Future Work}
What can be done to take this work ahead in future as projects.

\section{Bug report and Challenges}
Any issues in code and hardware.

Any failure or challenges faced during project

\begin{thebibliography}{li}
\bibitem{wavelan97}
Ad Kamerman and Leo Monteban,
{\em WaveLAN-II: A High-Performance Wireless LAN for the Unlicensed band},
1997.

\end{thebibliography}


\end{document}

